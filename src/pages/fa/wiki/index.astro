---
import BaseLayout from "../../../layouts/LayoutWiki.astro";
import { getCollection } from "astro:content";

const entries = await getCollection("wiki");

// Group by category
const byCategory = new Map<string, typeof entries>();

for (const entry of entries) {
  const cat = entry.data.category || "Uncategorized";
  if (!byCategory.has(cat)) byCategory.set(cat, []);
  byCategory.get(cat)!.push(entry);
}
---

<BaseLayout pageTitle="Coughy's Wiki">

  <main class="px-6 py-20 max-w-5xl mx-auto leading-relaxed">
    <h1 class="text-4xl font-bold mb-6">Coughyâ€™s Wiki</h1>
    <p class="opacity-80 mb-10">
      An encyclopedia of consciousness â€” concepts, states, tools, and maps.
    </p>

    <div class="space-y-12">
      {Array.from(byCategory.entries()).map(([category, items]) => (
        <section>
          <h2 class="text-2xl font-semibold mb-4 opacity-90">
            {category}
          </h2>

          <div class="grid gap-6 sm:grid-cols-2">
            {items.map((entry) => (
              <a
                href={`/fa/wiki/${entry.id}`}  // ðŸ”¥ flat URL here
                class="group block rounded-2xl p-5
                       bg-white/10 dark:bg-white/5
                       border border-white/20 backdrop-blur-xl shadow-lg
                       hover:-translate-y-1 hover:shadow-2xl
                       transition-all duration-300"
              >
                <h3 class="text-lg font-semibold mb-2 group-hover:opacity-80">
                  {entry.data.title}
                </h3>
                {entry.data.description && (
                  <p class="opacity-70 text-sm leading-relaxed line-clamp-3">
                    {entry.data.description}
                  </p>
                )}
              </a>
            ))}
          </div>
        </section>
      ))}
    </div>
  </main>

</BaseLayout>
